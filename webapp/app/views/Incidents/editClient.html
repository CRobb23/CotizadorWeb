#{extends 'admin.html' /}

#{set 'moreStyles' }
<link rel="stylesheet" type="text/css" media="screen" href="@{'/public/stylesheets/custom-theme/jquery-ui-1.10.4.custom.css'}">
#{/}

#{form @saveClient(), id:"formClient", class:"form-horizontal", method:"POST", role:"form", enctype:"multipart/form-data"}
	<input type="hidden" name="incidentId" value="${incidentId}"/>
	<input type="hidden" name="clientId" value="${client?.id}"/>
	<input type="hidden" name="client.id" value="${client?.id}"/>
	<input type="hidden" name="client.payer.id" value="${client?.payer?.id}"/>
	<input type="hidden" name="payer.id" value="${payer?.id}">
	<input type="hidden" name="client.multimedia.id" value="${client?.multimedia?.id}"/>
    <input type="hidden" name="client.codeClient" id="client_codeClient" value="${client?.codeClient}" />
    <input type="hidden" name="client.payer.codeClient" id="payer_codeClient" value="${client?.payer?.codeClient}" />
	<input type="hidden" name="activeTab" id="active_tab" value="${activeTab}" />
	<input type="hidden" name="doValidation" id="do_validation" value="true" />

    <div class="well fixed-sidebar-parent">
		<div class="orange-title">
			<span>
				<h1>&{'client.edit.title'}</h1>
			</span>
		</div>

		#{if errors}
			<div class="alert alert-danger">
				&{'client.edit.fielderrors'}
			</div>	
		#{/if}
		#{if flash.success}
			<div class="alert alert-success">
				${flash.success}
			</div>
		#{/if}
		
		<div class="row " style="min-height: 0px;">
			<input type="hidden" name="iField" value="${iField}"/>
			<div id="tabs">
				<ul>
					<li><a href="#tabs-1">Cliente</a></li>
					<li><a href="#tabs-2">Pagador</a></li>
					<li><a href="#tabs-3">Vehiculo</a></li>
					<li><a href="#tabs-4">Documentos</a></li>
					<li><a href="#tabs-5">Pago</a></li>
				</ul>
				<div id="tabs-1">
			    	#{include '/Incidents/clienteTab.html' /}
				</div>
				<div id="tabs-2">
					#{include '/Incidents/pagadorTab.html' /}
				</div>
				<div id="tabs-3">
					#{include '/Incidents/vehiculoTab.html' /}
				</div>
				<div id="tabs-4">
					#{include '/Incidents/documentoTab.html' /}
				</div>
				<div id="tabs-5">
					#{include '/Incidents/pagoTab.html' /}
				</div>
			</div>
		</div>
		
		<div class="row">
			<div class="col-sm-offset-2 col-sm-3">
				#{requiredleyend/}
			</div>
			<div class="col-sm-offset-1 col-sm-2">
				<a class="btn btn-primary btn-block" href="@{incidentDetail(incidentId)}" class="btn btn-xs" >&{'client.edit.cancel'}</a>
			</div>
			#{if incident?.policy == null || incident?.policy.trim() == ''}
                #{if incident?.status?.code == 0 || incident?.status?.code == 1 }
                    <div class="col-sm-offset-1 col-sm-2" style="text-align: left; margin-left: 0%">
                        <input type="submit" formnovalidate name="accion" id="btnEditPartial" class="btn btn-primary btn-block" value="&{'client.edit.partial'}" onclick="disableValidation()" />
                    </div>
                    <div class="col-sm-offset-1 col-sm-2" style="text-align: left; margin-left: 0%">
						<input type="submit" name="accion" class="btn btn-primary btn-block" value="&{'client.edit.complete'}" onclick="enableValidation()" />
					</div>
				#{/if}
                #{else}
                    <div class="col-sm-offset-1 col-sm-2" style="text-align: left; margin-left: 0%">
                        <input type="submit" name="accion" class="btn btn-primary btn-block" value="&{'client.edit.update'}" onclick="enableValidation()" />
                    </div>
                #{/else}
			#{/if}
		</div>

	</div>

    <!-- SELECTION VALUES FOR COMBOS -->
    <input type="hidden" id="country_selection" />
    <input type="hidden" id="department_selection" />
    <input type="hidden" id="municipality_selection" />
    <input type="hidden" id="zone_selection" />
    <input type="hidden" id="country_work_selection" />
    <input type="hidden" id="work_department_selection" />
    <input type="hidden" id="work_municipality_selection" />
    <input type="hidden" id="work_zone_selection" />
    <input type="hidden" id="country_business_selection" />
    <input type="hidden" id="department_business_selection" />
    <input type="hidden" id="municipality_business_selection" />
    <input type="hidden" id="zone_business_selection" />
    <input type="hidden" id="country_legal_selection" />
    <input type="hidden" id="department_legal_selection" />
    <input type="hidden" id="municipality_legal_selection" />
    <input type="hidden" id="zone_legal_selection" />

    <input type="hidden" id="country_payer_selection" />
    <input type="hidden" id="department_payer_selection" />
    <input type="hidden" id="municipality_payer_selection" />
    <input type="hidden" id="zone_payer_selection" />
    <input type="hidden" id="country_work_payer_selection" />
    <input type="hidden" id="work_department_payer_selection" />
    <input type="hidden" id="work_municipality_payer_selection" />
    <input type="hidden" id="work_zone_payer_selection" />
    <input type="hidden" id="country_business_payer_selection" />
    <input type="hidden" id="department_business_payer_selection" />
    <input type="hidden" id="municipality_business_payer_selection" />
    <input type="hidden" id="zone_business_payer_selection" />
    <input type="hidden" id="country_legal_payer_selection" />
    <input type="hidden" id="department_legal_payer_selection" />
    <input type="hidden" id="municipality_legal_payer_selection" />
    <input type="hidden" id="zone_legal_payer_selection" />

#{/form}

#{set 'moreScripts'}
	<script src="@{'/public/javascripts/jquery-ui-1.10.4.custom.min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
	<script src="@{'/public/javascripts/validations.js'}" type="text/javascript"></script>
	<script src="@{'/public/bootstrap-datetimepicker/js/moment.min.js'}" type="text/javascript"></script>
	<script src="@{'/public/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js'}" type="text/javascript"></script>
	<script src="@{'/public/javascripts/jquery.validate.min.js'}" type="text/javascript"></script>
    <script src="@{'/public/javascripts/jquery.mask.js'}" type="text/javascript"></script>
	<script src="@{'/public/javascripts/client.js'}" type="text/javascript"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			let args =  {
				urlGetGeographicAreaChildren: "@{GeographicArea.getGeographicAreaChildren()}",
				urlGetLinesForBrand: "@{ServiceVehicles.vehicleLinesForBrand()}",
				formSelect:	"&{'form.select'}",
				formSelectLoading: "&{'form.select.loading'}",
				formSelectError: "&{'form.select.error'}",
				phoneNumbersString: ""
			}
			init(args);
		});
	</script>	            
#{/}

